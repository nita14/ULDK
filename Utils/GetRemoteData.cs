using ArcGIS.Desktop.Core;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Reflection.Metadata;
using System.Text;
using System.Threading.Tasks;
using Newtonsoft.Json;
using Serilog;
using System.Collections.ObjectModel;
using ArcGIS.Core.Geometry;
using System.Globalization;

namespace ULDKClient.Utils
{
    class GetRemoteData
    {

        private static readonly ILogger log = Log.ForContext<GetRemoteData>();


        public async static Task<ObservableCollection<Commune>> GetCommuneDataAsync()
        {

            ObservableCollection<Commune> communes;

            //Get data from the endpoint 
            Log.Information("Preparing Commune request...");
            EsriHttpClient esriHttpClient = new EsriHttpClient();
            esriHttpClient.Timeout = TimeSpan.FromSeconds(10);
      
            EsriHttpResponseMessage responseMessage = esriHttpClient.Get(Constansts.COMMUNE_DATA_URL);
            responseMessage.EnsureSuccessStatusCode();

            var resp = await responseMessage.Content.ReadAsStringAsync();
            communes = JsonConvert.DeserializeObject<ObservableCollection<Commune>>(resp);
            return communes;
    
        }

        public async static Task<Polygon> GetCommuneExtentByIDAsync(string communeId)
        {

            //WktImportFlags wktImportFlags = WktImportFlags.WktImportDefaults;

            //string wktstring = "MULTIPOLYGON(((655330.399593194 471008.713569893,655284.591363783 471031.072577006,655274.261909847 471036.118273705,655273.694270273 471036.39265233,655273.258302197 471036.610718871,655131.716526074 471105.75450113,655131.280261949 471105.982474016,655129.250577941 471107.056631098,655126.835361716 471108.33018871,655122.065494574 471110.858832951,655114.880906289 471114.641141315,655107.015828643 471118.804612326,654944.467989135 471179.789297376,654820.619398204 471226.3493918,654806.442182279 471231.669010742,654801.763418329 471233.430186594,654796.539042095 471235.396378189,654795.366949614 471235.834039834,654798.46972595 471249.530229818,654801.91372431 471264.635808455,654804.571663868 471276.329509611,654807.229653813 471288.023325911,654810.654697948 471303.08837541,654813.366320499 471315.013655596,654814.418246639 471319.662880964,654817.14818854 471331.648602371,654819.74441717 471343.040723906,654826.068107594 471370.866256178,654827.173982163 471375.736939609,654813.689807323 471379.495620309,654806.423774864 471381.515505228,654802.866314173 471382.50749597,654800.135345398 471383.262385545,654796.638372312 471384.236011473,654790.388842662 471386.023952403,654789.02820725 471386.406447529,654781.408050678 471388.57658382,654778.183397073 471389.467786649,654763.197882342 471393.635097047,654761.635488761 471394.082091418,654760.547411981 471394.372149809,654751.346309802 471396.93878481,654744.604336128 471398.813160976,654736.874848521 471400.96026434,654730.566720964 471402.696490751,654729.730095117 471402.933512775,654721.637585203 471405.190633472,654716.820194018 471406.537952651,654708.697143251 471408.814284608,654681.537538243 471416.376318609,654675.269381839 471418.113745529,654669.0111637 471419.851378039,654663.279849512 471421.343573854,654660.55996813 471422.058711607,654658.181048009 471422.743173718,654658.204054576 471422.633835868,654653.981249376 471423.817549671,654640.335754307 471427.621743535,654638.813939165 471428.049785062,654632.797505213 471429.724098736,654620.673925017 471433.100304792,654610.233519815 471436.002764659,654599.792505456 471438.925256833,654577.832711064 471445.050485372,654566.223209056 471448.280784524,654554.623656761 471451.511308047,654524.778218462 471461.459478539,654506.25761394 471467.619471534,654504.168210268 471468.322016421,654502.563594324 471468.847786074,654492.813619909 471472.099320616,654479.339276799 471476.588276734,654466.702971672 471480.790283356,654464.956849365 471481.372202913,654446.994599766 471502.838381061,654433.779096391 471491.763673463,654428.090206381 471486.996762957,654421.961232242 471481.867668936,654416.584630557 471488.269811411,654405.841571207 471501.064412035,654398.83128133 471509.411701794,654387.058477367 471507.317164834,654379.674025825 471506.01368463,654375.106291009 471505.197834893,654374.847931672 471506.590793503,654374.376356708 471509.187828387,654373.917227414 471511.6953377,654372.916173259 471517.178043339,654362.925977954 471515.352681391,654347.51281647 471512.537853214,654345.99998669 471520.986570963,654345.763533257 471522.310106102,654345.208797893 471525.384945147,654343.30224553 471535.78292431,654338.6443001 471534.974543673,654333.823955609 471561.472909439,654332.692297565 471567.702020342,654312.032472334 471564.032715909,654308.499621976 471563.405281965,654302.349306998 471562.315816357,654274.066625361 471557.286396729,654258.38285864 471554.494155015,654240.870507729 471562.171938653,654236.862455658 471563.911588882,654234.655597944 471564.880891218,654228.710542275 471567.597221654,654220.068952684 471571.269234186,654219.583262387 471571.475831087,654169.173115744 471593.537940626,654167.168962051 471594.412740877,654165.28631368 471595.230997773,654150.882258966 471601.524380264,654140.273200583 471606.1923158,654122.578533951 471613.955090695,654121.647339792 471614.359422455,654102.799733893 471622.590494117,654096.280911293 471625.441082764,654089.660763018 471628.338836046,654081.987864107 471631.697481082,654074.062132162 471635.159355691,654061.773877539 471640.520963389,654056.358892883 471642.87190441,654049.728726232 471645.769398089,654044.606281643 471648.028266045,654039.474078451 471650.277044289,654038.047225864 471650.887695929,654034.341952001 471652.525718696,654029.209761882 471654.774396207,654020.767512547 471658.471945173,654019.735551588 471658.903551732,654018.550988919 471659.430913579,654008.195547315 471663.965877233,654001.413875452 471666.919050929,653997.830199176 471668.50044336,653987.737876163 471672.922529522,653983.101948689 471674.944931632,653980.571271713 471676.055202831,653973.394365261 471679.197693136,653966.217781548 471682.330077148,653960.781900297 471684.710404033,653958.393042852 471685.754640091,653955.335853524 471687.100436697,653949.41431643 471689.687398186,653945.324017434 471691.504734248,653935.383601285 471695.861076822,653926.404844172 471699.793873715,653915.503788405 471704.53379091,653911.353588697 471706.349521576,653910.104588202 471707.035040409,653906.393430239 471708.522859749,653895.359988479 471713.349077247,653890.896188469 471715.296214707,653888.143133427 471716.490448528,653884.973244247 471717.933169362,653880.894093605 471719.710841569,653876.986750281 471721.42328574,653871.582539179 471723.744485521,653870.459277857 471724.2234815,653866.287153994 471726.108673909,653856.528794105 471730.390015488,653851.793236156 471732.399547467,653851.459313873 471732.540437784,653847.106746209 471734.440535823,653846.944940708 471734.506077596,653839.626273205 471737.714580929,653839.454160375 471737.789818862,653835.797714281 471739.469220054,653831.283112911 471741.444881312,653822.000955309 471745.499331086,653811.827911224 471749.949194461,653800.743986475 471754.793969335,653790.479889589 471759.281450797,653788.305518961 471760.161591033,653780.90608353 471763.397834308,653780.156922523 471763.727183006,653776.330917781 471765.391810783,653772.049430632 471767.253999677,653767.401049333 471769.366009263,653760.993491996 471772.169495551,653750.820492645 471776.619479743,653745.941436395 471778.75508611,653740.313225515 471781.22016297,653729.444095738 471785.890908508,653722.044915638 471789.11711732,653704.452080717 471796.812802709,653693.459193039 471801.620116672,653693.165519067 471801.752024145,653687.19180839 471804.417567924,653681.968902326 471806.693717043,653676.725383645 471808.989375231,653672.059527145 471811.010907015,653667.322277387 471813.080421714,653661.653606161 471815.56436279,653651.329034564 471820.070056933,653647.918459548 471821.536194888,653639.071582866 471825.402570171,653637.897276595 471825.92020959,653633.814070218 471828.207819603,653603.925430795 471844.805076824,653543.680958518 471878.266531816,653426.821162769 471941.229370841,653422.910170604 471942.711700958,653348.455342408 471973.621557559,653333.541153562 471978.470785939,653330.089606685 471979.24573276,653323.307356331 471980.768871265,653316.726104537 471982.257602727,653309.339336715 471982.854099652,653308.825604867 471993.150334268,653307.97598198 471993.136925968,653285.637302194 471992.691454793,653246.485976542 471991.592620595,653190.227509072 471990.362532011,653170.168583157 471989.929754901,653146.851798627 471989.417267041,653124.224425872 471988.923789819,653122.475430261 471988.885600331,653071.893724584 471987.78187984,652983.301392855 471985.920814379,652972.759794713 471985.600385172,652986.313189388 471937.591815938,652984.347776779 471937.057623813,652959.490435584 471930.392461999,652877.81004707 471908.511089585,652818.597455124 471892.548958209,652815.222220261 471891.645899126,652781.212640146 471882.508495956,652727.834782815 471868.197209375,652725.54158839 471867.583948907,652713.37108913 471864.318533611,652686.111473443 471857.007122609,652680.691489524 471855.547731517,652679.837611232 471855.324212751,652614.785884376 471837.871170014,652596.8078809 471833.055610548,652584.419175457 471829.724176695,652577.231991456 471827.796043528,652554.062144628 471821.587351506,652539.379744913 471817.662757374,652538.345655336 471817.084217545,652530.832627239 471815.367146973,652541.630556737 471690.969742174,652545.019600175 471591.199242747,652543.521170358 471591.137906672,652534.560137154 471590.801073188,652506.179395582 471589.699102322,652503.062749222 471589.573224471,652477.810597142 471588.527334172,652469.5894963 471588.190835778,652366.404135859 471584.247794329,652237.834300163 471579.345193993,652187.286189137 471577.392436733,652137.906677705 471575.491870005,652026.570915888 471571.194194016,652008.429491859 471570.494338215,651930.219705429 471567.479350598,651918.231886202 471567.019079962,651829.5729485 471563.596237725,651650.117192236 471556.671617007,651413.083818012 472371.269603953,651354.533917247 472535.952141293,651537.36549245 472544.840393906,651677.481867797 472550.961573936,651719.110613853 472553.238765036,651727.408734656 472553.31740481,651743.101160452 472554.339885144,651900.816173594 472561.626011287,652059.823510659 472569.197830898,652082.481863934 472570.01224489,652110.753877095 472587.761943967,652128.921880868 472602.013022481,652149.727311389 472624.707243189,652183.387987898 472649.40570077,652193.41566905 472656.762295577,652195.52985267 472674.031183166,652200.173743821 472712.000620562,652205.658910286 472725.612329599,652222.067328942 472766.336010471,652238.043250864 472809.327876262,652246.772488882 472823.158984931,652247.021557087 472823.555856637,652250.260049666 472828.695290432,652262.879166679 472848.703772708,652290.807188303 472880.024553959,652296.190958953 472886.063110502,652313.296918768 472910.185457811,652328.328184354 472939.19079513,652350.596290794 472970.135601282,652398.168685068 472998.057599909,652454.785418266 473031.279098405,652462.629064147 473035.875419263,652512.883680551 473077.511916181,652523.744681303 473086.561623443,652579.389455991 473118.766226397,652598.869635564 473131.12351467,652604.494486649 473137.488759261,652621.136274906 473156.318113718,652637.16572743 473208.251946431,652652.08808283 473249.554823863,652649.551385512 473288.986462298,652647.427086335 473322.159270368,652638.815041326 473337.462500096,652599.632332877 473407.175471091,652588.50888371 473434.499982012,652571.420755535 473476.500763345,652555.341318719 473501.858567916,652549.436625885 473511.816255129,652524.748268698 473549.097393179,652498.424144451 473573.882910551,652490.565903182 473595.217160434,652477.745005867 473620.994787222,652465.253256488 473663.13216251,652453.53121801 473686.050063985,652435.011070196 473725.581145899,652421.011842112 473743.676099733,652397.277848892 473778.983324848,652366.195724497 473808.407902316,652352.357737147 473827.547287549,652328.64586916 473837.014185488,652326.845013282 473838.494565952,652280.052097384 473876.996473918,652224.795844948 473907.264763665,652194.016354401 473930.787434589,652192.055357654 473932.273413901,652135.985742753 473961.209229755,652106.292122882 473983.431697288,652105.251457713 474009.944002251,652096.065269455 474036.641864205,652083.523470018 474054.106859524,652088.284596082 474072.938764152,652093.966423693 474095.376257778,652111.143393072 474136.511179745,652121.740668011 474164.564315918,652123.465078148 474169.122000308,652130.654922738 474206.871609296,652144.703421578 474216.379201225,652152.70463295 474221.789921454,652170.611701988 474233.893895726,652196.611602528 474246.270949068,652243.732559221 474249.929765142,652292.356269647 474249.499883894,652316.312498896 474270.350983637,652318.519933552 474272.261847026,652323.852320959 474276.898990178,652337.100102533 474268.653830579,652400.501311553 474229.14969195,652458.780658899 474206.035025888,652544.098791647 474196.426100287,652602.851713573 474229.786674174,652666.274918135 474254.795718337,652692.612635382 474273.42227749,652706.912069574 474295.957306664,652705.574084314 474312.211100108,652693.359543418 474333.765303321,652687.994183595 474376.039147611,652657.670146392 474420.045053283,652611.678280195 474477.009684773,652596.879206384 474512.873324504,652595.005368469 474530.06230149,652586.244900107 474550.021667469,652575.50092823 474596.227303645,652561.693426242 474641.46855744,652535.434827675 474672.946020769,652505.972901397 474718.325748979,652505.288341253 474724.657134679,652500.540138514 474768.847986555,652503.186895603 474797.632108495,652504.413834367 474832.937355988,652511.214385798 474849.615376001,652518.426757914 474895.61603124,652515.570451546 474961.86992098,652516.99799106 474973.209723051,652520.400934335 475019.545293246,652528.006878764 475053.806334479,652528.31880248 475061.355198632,652529.145267632 475081.438752535,652542.233569113 475110.180693821,652557.416481884 475131.500045188,652559.881244571 475134.958118313,652568.748293257 475147.412948059,652586.600319879 475166.955879719,652617.93423012 475183.91023564,652661.854397936 475186.870972203,652674.006083997 475185.375816947,652713.97725993 475178.497286844,652723.268812736 475174.463316333,652767.525209239 475138.381690038,652821.202361698 475101.919802446,652875.2553427 475091.369273448,652900.404653209 475101.952956441,652938.371964718 475119.520115696,652980.256801096 475160.766287584,653013.363105556 475204.120638285,653018.554972589 475214.944266519,653023.999570752 475228.934832348,653031.354837917 475272.289428749,653034.824232643 475357.208497101,653036.588877263 475382.438221517,653037.740337123 475398.71064174,653037.840947195 475411.023831624,653035.070106519 475419.757879349,653028.334168614 475441.003065093,653045.127907699 475471.367208849,653053.767346568 475478.65563997,653055.428637261 475480.061534492,653062.08525819 475485.635286088,653068.780803708 475491.250084482,653070.911813131 475493.028888216,653087.448055415 475506.975283972,653119.591561848 475529.752254534,653127.745800807 475534.327177547,653167.672264411 475545.398184661,653204.610708088 475547.686594749,653243.167061976 475554.769619693,653278.080019145 475548.911794201,653288.227319602 475547.211410162,653323.872496724 475549.254138988,653337.381974988 475548.206392453,653355.351417348 475546.801702513,653388.814816419 475542.013977029,653419.787596509 475540.147648787,653446.7238368 475542.140253776,653515.431509246 475548.134459905,653560.989111869 475561.350842265,653588.739150202 475572.276251057,653624.261656796 475592.556261405,653657.273986462 475616.467280403,653675.090376625 475644.559652047,653697.544010966 475674.2098824,653704.694166788 475683.647351683,653710.105863809 475687.946742065,653744.982645176 475715.689321843,653754.681344585 475725.547083963,653797.316891347 475768.944300554,653819.285067967 475799.881280623,653847.467966996 475848.430250489,653878.404683257 475862.383641316,653891.186451191 475868.146325649,653904.6693332 475874.228225486,653941.106207395 475897.253648308,653956.616733565 475930.272707211,653999.224349772 475964.888822779,654014.173966275 476005.192634556,654053.181758239 476046.68984047,654055.231842679 476048.86651828,654088.341494558 476097.541363037,654090.696094678 476101.006427397,654111.021656409 476137.83835761,654125.383986267 476158.815285348,654145.552337877 476188.292590503,654177.079682471 476267.155245744,654203.229710077 476313.628299641,654229.872657242 476367.975187114,654271.663864959 476394.118444334,654352.639040813 476405.671366335,654396.643767907 476383.083441604,654442.364418242 476370.803247684,654489.993359317 476361.125903908,654535.679150637 476361.35538955,654574.419266872 476363.593447719,654603.740529698 476364.321816429,654699.917851225 476431.326279894,654719.002846336 476466.724125994,654724.990429413 476521.231707746,654709.678465218 476569.52185584,654696.80962042 476610.80908234,654664.72247989 476670.137249677,654625.802059385 476700.555593466,654606.806997964 476745.324008695,654558.327489089 476804.710218134,654536.891847515 476838.610831343,654530.171437661 476880.327445576,654529.086114401 476887.047927402,654519.040719638 476921.322531584,654520.091234821 476952.862883488,654529.539456698 476967.814141026,654537.857523947 476980.954107859,654540.796271445 476982.455189444,654573.547551044 476999.148923222,654631.245952222 477002.569782138,654689.476725157 477001.915186584,654737.995317813 477025.623939305,654805.31208141 477073.372158146,654861.69427541 477131.059394443,654889.443708764 477189.887154239,654905.685526148 477235.187201335,654908.928557716 477265.548007253,654960.62967581 477340.677089505,655021.067075279 477402.896368409,655062.520657987 477428.590518938,655094.425101052 477437.550588269,655141.874906685 477460.129983088,655205.972420413 477481.368308268,655249.025631506 477489.305740143,655306.388722167 477505.618107148,655332.920581472 477497.979264518,655344.35198823 477494.684284276,655364.065876301 477490.227624342,655375.598432183 477487.61546615,655402.151440089 477494.807889614,655423.280029058 477515.571470886,655449.120829338 477540.975145609,655457.415436071 477577.455695023,655459.653994545 477639.530481564,655452.635177471 477681.909023103,655460.030423383 477724.164996004,655484.314377713 477749.81592677,655512.124493052 477764.733403741,655562.818008098 477762.521096559,655623.912804736 477759.55546953,655662.344602559 477731.63368153,655694.087671736 477697.487246811,655721.530929629 477642.291170588,655768.385893213 477577.639764627,655811.063878304 477512.14315901,655842.95455155 477482.800937489,655864.758646711 477416.318761176,655895.263126113 477395.538701606,655922.500445165 477382.62904661,655960.88430326 477375.306943863,655981.987502993 477386.109372687,656006.742532714 477425.143917533,656030.661917548 477516.248024995,656033.074313233 477558.236763275,656042.209708026 477596.140515179,656064.396008256 477632.584164736,656099.536065401 477661.664528152,656134.649266603 477675.033394746,656208.272335388 477697.184468612,656269.853570643 477705.232786437,656336.144163328 477690.829808739,656369.700294197 477678.704396389,656415.13672416 477671.666802142,656456.108654704 477648.825375573,656520.230478149 477642.352939997,656553.474289591 477656.060332708,656618.080906893 477662.111892823,656662.441197077 477659.28493482,656725.688535354 477680.539952837,656779.360536941 477695.080523476,656807.078368659 477702.105206046,656874.501989909 477704.644328048,656939.790907456 477733.8260649,656966.464035419 477753.71257834,656994.254302643 477774.429925694,657008.905285452 477793.284948422,657031.416815893 477822.287309469,657085.934900315 477850.39206078,657113.160069514 477861.863311511,657135.052376006 477892.288570716,657137.115782533 477916.106788657,657131.821911826 477960.843296885,657111.544983618 478019.807488454,657104.586535549 478040.046711067,657099.777530213 478088.236757629,657111.986456977 478127.105522646,657115.344335282 478129.728284945,657133.924043724 478144.281406905,657171.452631726 478153.836673895,657221.837173504 478163.566527931,657248.766799327 478164.359109063,657267.686028491 478177.481529426,657310.076809396 478210.902314038,657338.014418885 478245.134555588,657344.815213409 478253.462503254,657360.824582657 478283.255652302,657385.779201207 478305.985047468,657407.742963086 478321.851493259,657439.099947118 478344.507476864,657471.066723326 478348.679138324,657567.033243956 478345.375133619,657574.116143256 478343.110406179,657614.998337789 478330.056937572,657624.17949292 478327.859951867,657671.868033449 478316.404236374,657682.063788353 478310.415050124,657711.238517767 478293.258573841,657785.803979663 478220.320470813,657787.181334819 478218.968353226,657814.715046665 478210.187116918,657830.302353451 478188.195597861,657886.218519022 478172.856568691,657950.815306215 478168.757552664,658004.829600137 478160.736430114,658013.495433972 478159.455274165,658017.150478826 478158.916020907,658049.243658028 478154.880714353,658088.211637028 478130.37375861,658115.859469219 478124.345796184,658127.550676808 478121.788032395,658139.12820178 478122.627254901,658199.040909256 478127.009541347,658261.172212419 478132.53309752,658287.874544531 478138.3096504,658338.138453748 478157.496793129,658359.665835416 478184.111934965,658389.793089006 478223.44500746,658391.578918179 478225.774320295,658394.343233261 478241.581563771,658401.373038829 478281.857763515,658404.232111199 478298.217559866,658419.896808335 478316.94066447,658453.680005048 478332.853090514,658493.804546707 478327.699224996,658513.050324064 478321.729553301,658539.452952848 478299.206255974,658569.519357014 478246.45209677,658613.921390469 478154.720918195,658635.419351826 478078.319151748,658644.900844364 478030.777690437,658666.805960661 477967.89785926,658681.673764437 477947.33658042,658696.260755591 477927.167646254,658711.522889026 477910.077417689,658735.787830125 477902.335980272,658740.917209039 477902.007337515,658774.428126195 477899.871273996,658792.93920895 477883.190618658,658801.081918598 477875.854695431,658834.051600665 477830.240980838,658844.472432229 477810.287155965,658846.906151367 477740.160002628,658865.73706986 477706.077043094,658878.998389568 477689.011676625,658937.71330715 477658.858746311,659014.859455838 477635.234359272,659104.023227717 477599.390578297,659131.92664089 477584.4589608,659185.802048641 477549.2022553,659210.586806388 477531.674454357,659246.609806184 477496.465515264,659259.795422879 477510.800005557,659286.842882847 477633.54336528,659290.059416989 477648.1828973,659300.12905529 477664.541569049,659307.833365067 477708.286689579,659311.30077088 477727.973579668,659311.81401996 477757.959557599,659312.913613427 477821.083877278,659314.182826239 477843.600258457,659315.59450376 477868.930808815,659320.662137965 477959.336149085,659327.742705557 477956.791227529,659370.24556679 477941.552129026,659380.578393996 477937.846899305,659414.572762297 477925.433429373,659450.585173993 477912.735609734,659484.163663396 477899.810566778,659517.721906221 477886.895106563,659552.917410382 477873.354684586,659556.354191841 477872.029309116,659589.395645958 477862.259732354,659626.45988717 477851.310981099,659660.50950902 477841.249238309,659672.197271715 477840.6313865,659740.781436917 477837.012178936,659809.806120259 477833.375161784,659820.692822206 477832.795286287,659886.533447808 477837.641051172,659938.850594992 477841.49373061,660014.262981446 477847.023473519,660031.698783207 477848.304312671,660074.086094777 477851.403234785,660228.943303454 477846.79272591,660332.104638172 477843.726921476,660370.959156227 477842.568165329,660470.80693157 477837.810856076,660623.317907388 477830.525495043,660623.4696709 477805.438040411,660630.730056982 477802.177950567,660631.318708612 477801.864153489,660643.622354921 477796.323088154,660650.275416882 477793.326249381,660659.115612772 477789.34970511,660676.705648908 477781.414211974,660679.348522009 477780.227028169,660681.991720458 477779.029840527,660684.634599789 477777.842548324,660687.277800876 477776.645363445,660689.92074763 477775.458187394,660700.158402752 477770.490124465,660703.581566266 477769.294395847,660704.582747123 477768.892031403,660708.997897121 477766.903587598,660720.375256841 477761.586987665,660722.223253025 477760.937850283,660724.30402107 477759.465171709,660730.720230457 477754.901759845,660741.441176145 477747.276794003,660746.612646796 477743.609210503,660747.744792988 477742.810357193,660754.27315851 477738.170036481,660758.945037268 477734.848624541,660764.188119066 477731.122950169,660770.573283693 477726.598643169,660775.306524192 477723.228932696,660780.478304579 477719.551265019,660784.395254133 477716.769074275,660785.568128265 477715.941390367,660788.872842673 477713.602311624,660793.891420674 477710.040437236,660800.923785141 477704.894020125,660806.710539704 477700.673313703,660815.978004411 477693.898353423,660819.294914556 477691.479674228,660827.756016708 477685.292561903,660828.592819355 477684.685579709,660833.246938396 477681.283642477,660838.115049156 477677.737631245,660841.544352543 477675.232022546,660841.993460286 477674.904377323,660849.240033421 477669.603825839,660852.199754502 477667.445236287,660855.016559811 477665.392855811,660864.018681302 477658.810581246,660869.047859225 477657.039155777,660869.916342777 477656.733011631,660873.440854667 477655.490156249,660876.823801357 477654.303363949,660879.015181934 477653.533653334,660881.226791801 477652.754583857,660884.187286942 477651.656147496,660889.259706517 477649.765843749,660896.485810668 477647.024938617,660908.227236992 477642.648342633,660912.928315085 477640.807894289,660916.495821282 477639.456178259,660918.628379422 477638.644847612,660920.477726529 477637.945856747,660922.34737851 477637.23728679,660924.712231125 477636.342460815,660927.346314392 477635.475064323,660929.361132586 477634.580572342,660933.848240377 477632.884106766,660947.552303003 477627.691655326,660950.55808224 477626.764437175,660968.656593878 477619.972968752,660976.410522177 477616.946601307,660976.397259704 477617.066248698,660991.049755294 477611.569824038,660999.517960615 477608.393061196,661019.445558714 477600.912055803,661036.694963497 477594.447159875,661038.119701419 477593.916382826,661048.275938457 477593.716416922,661074.988023925 477591.892843192,661090.953084247 477591.022859508,661100.125679229 477590.22572933,661106.807955811 477590.16003243,661122.783347477 477589.280358788,661138.878855374 477588.394176242,661150.186395673 477587.78588416,661155.136597866 477586.70226045,661170.259026518 477583.38902457,661185.180166907 477580.120152478,661215.032434633 477573.58275284,661226.18059722 477571.140016456,661240.98099544 477567.897765857,661262.149999761 477563.271146012,661287.79731833 477558.717960765,661306.912631806 477554.944774986,661326.721366702 477551.050647564,661346.238669231 477547.208550823,661356.563802494 477544.872992421,661369.284093051 477541.99348191,661380.685863922 477539.417664694,661394.050402347 477536.386008313,661404.696436252 477534.379376507,661423.474867266 477530.856860511,661427.131278068 477529.907577167,661478.138594829 477504.382214156,661484.791096676 477501.045335501,661495.033426141 477495.907389327,661514.747422152 477486.020234881,661523.54958794 477481.61258046,661527.626300406 477479.564851128,661534.896869062 477475.935107145,661554.852943995 477465.974634145,661592.312474322 477447.226130097,661599.065980593 477443.852066398,661612.816098969 477436.99069191,661609.841501639 477430.258223402,661609.110688049 477429.198007265,661590.430504702 477386.719999443,661572.494612141 477345.902565442,661558.538969507 477314.155575356,661554.548751521 477305.085001349,661546.563062391 477286.773537344,661538.486828277 477268.479619026,661537.272666878 477265.72592341,661530.41067016 477250.185608727,661522.354421888 477231.892263339,661514.278014531 477213.608294362,661506.221778051 477195.314871631,661500.743342031 477182.912962264,661498.446911687 477177.699343901,661490.098232984 477158.767779309,661482.032086354 477140.474195689,661479.472098265 477134.663194924,661473.965878985 477122.180515599,661465.909663057 477103.887177406,661459.386718884 477089.10631114,661456.101576766 477081.665200003,661454.755527834 477078.617894311,661451.376280328 477070.964172965,661449.805236975 477067.370588409,661443.396978078 477052.782889859,661435.417423865 477034.611630802,661427.428397706 477016.420159813,661419.863200433 476999.180413497,661401.801639313 476958.929580683,661377.6159444 476905.0291664,661376.928047344 476903.500091252,661376.239896514 476901.980912467,661367.807392554 476883.187217621,661354.843510301 476854.277736917,661353.965978138 476852.373474781,661341.909859592 476826.449316133,661336.632546813 476815.093034856,661320.989512819 476781.429446565,661316.60893837 476772.008007281,661308.112784321 476753.7124931,661295.717267883 476727.038949456,661285.360979767 476704.751956237,661277.758769665 476687.401110253,661277.062560494 476685.811799323,661258.235367159 476642.859873677,661238.721922942 476598.318836556,661235.656607311 476595.604143095,661235.245005308 476590.582449382,661231.755235203 476582.585683334,661227.597762254 476573.0504006,661209.704786076 476532.124307577,661166.700146616 476429.531736243,661107.119483717 476288.659649245,661098.548195056 476268.371916203,661087.243494988 476257.26950887,661081.907507327 476252.032058888,661075.938487461 476246.17713583,661072.22905511 476235.264148703,661064.752449746 476187.964865209,661063.43374579 476177.757781614,661063.169929021 476175.720368818,661056.632805884 476125.176674173,661052.194569047 476091.002022178,661030.538625727 476043.641784785,661029.001256771 476040.279270264,661023.965313086 476036.490113005,661022.035575871 476035.026875089,661002.382297403 476020.224081444,660972.559223631 475997.770436035,660963.535444596 476004.052151055,660956.975516657 476009.111612949,660947.963008935 476016.073675406,660940.506774179 476002.857249017,660937.503036772 475997.544019482,660928.140455979 475991.085510995,660916.198274389 475979.165523388,660887.029344827 475949.669440228,660883.964184111 475946.584755254,660872.093025831 475934.626679301,660864.70770571 475927.182618879,660841.629173327 475907.485130611,660841.111363242 475907.040794918,660807.158425712 475878.042925438,660803.719134833 475875.107874283,660787.109147688 475860.919050868,660779.752126123 475857.52605894,660771.121515451 475853.537854845,660754.156729747 475845.689722929,660748.863811631 475843.243662147,660733.062586732 475843.248078192,660718.31208623 475843.231473755,660715.901812097 475843.23501731,660689.269871923 475843.240844756,660677.636106897 475843.350171524,660665.131793757 475843.475532227,660662.812023814 475843.461553964,660646.612760608 475843.39504957,660644.763491321 475843.364032012,660625.034783708 475843.270193185,660615.115281631 475843.226804972,660610.757241008 475843.146573761,660606.438839971 475843.077533148,660596.084389113 475842.85218241,660569.456203845 475842.35810054,660561.659978737 475842.203211857,660560.690929005 475842.166417928,660529.725779017 475841.552873361,660520.059731444 475841.386331429,660499.519871668 475840.970188489,660497.533730255 475840.825407438,660490.248156575 475840.284510198,660485.167704221 475839.924411898,660482.692997875 475839.72622882,660468.142152081 475838.63501815,660458.242803403 475839.3121642,660453.554477168 475839.602992409,660439.126997052 475840.565391573,660440.71984924 475827.768449047,660446.946306889 475780.026837387,660481.342743191 475746.862885867,660533.286155358 475696.801406839,660565.955812193 475665.329774437,660627.477364934 475603.751573071,660627.764057265 475603.509454993,660634.393848296 475597.0017659,660641.167197546 475590.36808081,660649.066074247 475582.445192385,660719.264684083 475513.375624445,660736.310549044 475496.514391337,660739.209360818 475493.664071626,660814.451545169 475419.033039535,660864.618519688 475369.562509165,660949.805592348 475284.984888502,661045.444786624 475189.834675459,661046.534589442 475188.754604628,661047.295314899 475188.005508,661102.688557297 475131.428465332,661177.262265181 475060.369125932,661179.822714231 475057.819545371,661189.056550188 475048.633378841,661198.187399806 475039.554391511,661204.56272753 475033.209732169,661212.140823285 475025.678091499,661212.418350672 475025.405770749,661224.158262908 475013.828474133,661269.637841525 474968.96893529,661316.145289921 474922.737621717,661361.80938152 474877.353115921,661363.578057471 474875.591728167,661366.433156606 474871.060123972,661370.366554811 474864.778088007,661370.732025893 474864.218176584,661420.48107283 474789.274234604,661423.141703493 474785.267282977,661488.712908496 474684.887568489,661548.096663793 474594.558008488,661586.03691748 474536.229571602,661660.641818172 474424.487946602,661808.933333356 474520.961823893,661894.247652827 474576.537131643,661982.263561258 474633.876983125,661988.958264369 474584.378036041,661995.52720895 474535.815588268,662008.809330133 474437.444666293,662010.431191406 474425.408504191,662011.839340454 474414.95654743,662013.118080684 474405.571169565,662014.853811312 474392.668127664,662017.04104753 474376.44722521,662019.517875275 474358.064122961,662026.805070945 474304.121168404,662029.695129586 474282.719323588,662031.980481711 474265.841029328,662037.707449616 474222.425760931,662044.369980876 474171.915782206,662047.476928015 474148.449754343,662048.767519859 474138.634647175,662052.178418917 474112.846749334,662054.385128894 474097.006538076,662058.197449371 474069.719577032,662065.232821795 474019.469951912,662073.28337738 473961.777667777,662073.432213358 473960.731644491,662073.904712447 473957.374520355,662087.805459851 473859.050535045,662101.919217036 473759.162384565,662116.950321275 473653.56904428,662137.564715399 473508.676806326,662148.940577698 473427.934508145,662151.032255665 473413.001009384,662156.092572322 473377.077930798,662140.173472875 473382.809703318,662081.688442026 473403.889457007,662079.004598759 473404.745613815,662075.37296873 473405.885572244,662035.794520436 473418.425760413,661986.931849818 473430.01007193,661979.14679618 473430.53559597,661972.995078136 473430.946114848,661887.671712489 473436.655158546,661827.203091427 473429.918404622,661738.539483994 473409.863636375,661708.28506932 473407.769768281,661677.735130029 473411.318128955,661664.790222232 473416.181653105,661659.837344709 473417.725285998,661656.306697182 473418.828099679,661637.670688619 473426.255065278,661624.011802554 473430.898932496,661609.17798415 473436.080522746,661607.360177296 473436.7204924,661594.393018443 473441.303473634,661581.660938391 473447.152998942,661568.950427308 473451.493107098,661555.90147016 473456.863877151,661549.275807529 473459.231379214,661545.681811408 473460.092387726,661534.625094456 473463.938048474,661531.394958517 473464.658991978,661514.456563829 473471.452735154,661498.511543371 473478.853837805,661495.15869347 473480.761573408,661492.328379405 473485.483910053,661490.064699352 473489.241789735,661489.823523872 473489.645151604,661487.137288774 473493.131337135,661484.170988544 473496.979892974,661480.012283534 473502.365723866,661478.290641022 473504.598359295,661476.511276904 473506.749438567,661472.632500233 473511.412891479,661468.866643034 473515.969510188,661468.422078569 473516.497246142,661465.569455379 473519.488821967,661461.697428802 473523.542433149,661458.690238848 473526.699812963,661457.038581819 473527.844351209,661452.388896598 473531.086462648,661447.484173397 473534.511479337,661443.607856313 473536.544793313,661438.462870048 473539.253231859,661437.163953983 473539.937498027,661433.21211957 473541.808670743,661428.024305539 473544.25587567,661421.96526325 473547.109126751,661417.284014456 473549.320293888,661414.568359175 473550.605550992,661411.244746545 473552.544002374,661403.0523369 473557.328659644,661395.205469523 473561.912666854,661390.84424215 473564.122680056,661387.172198371 473566.001641097,661380.702920203 473571.403744441,661377.458259436 473574.10441784,661375.992980791 473575.744247255,661374.579037495 473577.335332109,661370.05645624 473584.311161594,661367.027932208 473588.968030371,661366.662192078 473589.537952551,661364.25163913 473592.091786397,661361.305230351 473595.220813258,661358.358756748 473598.349839581,661353.733578324 473603.242642967,661352.695569991 473604.984159788,661349.707337485 473609.99222853,661346.603696597 473615.196976222,661343.887971164 473619.752507673,661339.725660908 473623.818033518,661335.233908624 473628.224526724,661325.36731919 473637.873314952,661324.946048133 473638.28174166,661319.765961951 473641.899248801,661313.363056837 473646.343080358,661303.931312839 473652.913621807,661299.996071286 473655.635320482,661299.802034025 473655.78003513,661296.827960199 473658.09826146,661293.598019598 473660.629418141,661290.787480077 473662.092051649,661279.291535095 473668.085598989,661272.828428562 473671.447720727,661272.077367104 473671.847115064,661265.322450346 473672.371004789,661260.251125978 473672.771273085,661252.984889904 473673.341013274,661243.984643758 473674.053016962,661238.201827041 473674.5036634,661237.341361072 473674.520028274,661229.53764312 473674.6348948,661220.963607671 473674.758717198,661214.71076832 473674.846370306,661214.020422271 473674.85735375,661203.326166255 473675.712658603,661195.77903723 473676.314765391,661189.915684494 473676.783219649,661184.391974396 473677.631055349,661173.394986799 473679.308015764,661173.214548626 473679.323083571,661161.895762864 473680.341279914,661152.120812271 473681.221953542,661151.920385722 473681.236373726,661143.31104132 473680.829131206,661135.530824769 473680.454694392,661135.370959557 473680.450288178,661131.737494043 473679.840111745,661126.242219085 473678.928620597,661118.527091143 473677.64589556,661110.473517065 473676.303797778,661109.059711583 473676.074884024,661106.640308318 473676.048172216,661102.181461457 473675.995277245,661095.163010419 473675.921928404,661083.225720276 473675.792926223,661078.057117565 473675.730505111,661071.028676888 473675.65675515,661053.822573371 473675.472627026,661053.492524125 473675.473501044,661047.23961311 473677.741330477,661043.92656835 473678.930072545,661039.077890565 473680.686560495,661029.390914897 473684.179855141,661027.633124516 473684.821528384,661025.936146978 473685.434792454,661023.511908024 473686.308039702,661011.562001752 473690.628987099,661007.784109073 473691.994987621,661004.137512846 473693.314499938,661000.803031237 473694.192756684,660991.263072015 473696.710018914,660987.122532577 473697.805989543,660981.662758018 473699.235581443,660979.742667627 473700.322717149,660974.520315311 473703.298973881,660971.553616688 473704.987415957,660966.94101599 473707.610409319,660964.431694304 473709.03134433,660961.92204991 473710.462285759,660954.98275468 473714.411319631,660952.000561524 473716.299250276,660946.778805479 473719.61564145,660939.796595934 473724.033485039,660937.709988108 473725.356062768,660931.847372778 473729.064798413,660925.435265803 473733.118307935,660918.483267903 473737.527031257,660912.274551084 473741.456162182,660898.204788889 473742.138456021,660889.112364977 473742.568002064,660884.366020968 473742.787205948,660878.780684432 473743.693361265,660869.227118262 473745.250129291,660860.376963155 473746.686356651,660854.03799947 473747.72171019,660848.221687919 473748.661484711,660839.964100366 473750.003979432,660835.534032953 473750.722010853,660834.870934133 473750.833751163,660831.60842712 473750.553744333,660826.350848581 473750.088852773,660818.80820996 473749.440935162,660803.573570752 473748.12104754,660798.295489513 473747.675553541,660793.587860594 473747.215699779,660788.391083592 473746.722547086,660783.693447466 473746.263026199,660778.975563494 473745.812981433,660772.382491079 473745.181176897,660771.59777688 473745.349640164,660758.526436219 473748.269528652,660754.712903711 473749.114527327,660753.153224093 473749.461567967,660751.593289417 473749.818616481,660749.611174652 473750.25403726,660743.301728914 473751.67018995,660739.397410039 473752.542643349,660730.612876179 473754.500700367,660724.08219495 473755.96079878,660720.177883526 473756.833267146,660716.75655862 473757.599061619,660702.810047273 473760.704892406,660697.839054897 473761.817968708,660695.339239045 473762.529121052,660689.190337757 473764.289841705,660683.323683648 473765.968222739,660676.781701201 473767.838101161,660667.941494737 473770.364689432,660663.808538835 473771.550863152,660659.917588122 473772.663628709,660651.984732145 473774.925239864,660646.410408778 473776.521640529,660641.420872138 473777.94432304,660640.694990036 473778.154326296,660620.981917681 473777.130980497,660609.450323917 473773.53289238,660601.250504571 473770.966762093,660597.936461114 473770.015418863,660586.377427428 473766.686587159,660566.468408657 473760.797541499,660544.518787089 473754.562194236,660524.438315683 473749.088437442,660515.178307675 473746.163133302,660488.447984927 473737.765887231,660470.1476608 473733.741257082,660451.912416801 473728.808377907,660421.935193403 473725.732092314,660415.193951863 473725.036220082,660344.240322993 473721.370683518,660329.58824655 473719.596765688,660295.011517179 473715.403525185,660197.000306415 473668.769481826,660094.000466455 473616.267603881,660064.019598627 473593.369905808,660063.050101681 473592.623112957,660049.190554739 473582.050522532,660013.753939272 473554.992200096,659961.940782509 473515.431791424,659956.974865504 473511.644713867,659950.51052624 473506.706241591,659946.533794493 473503.676482546,659942.381019893 473500.501731997,659940.608065185 473499.152870712,659938.42471805 473497.09249146,659927.245499377 473486.51374479,659925.335084366 473484.71098855,659916.416732717 473476.284720637,659910.675650128 473470.866135945,659905.012936665 473465.509729087,659902.566351543 473463.202190768,659896.413114576 473459.312421118,659891.783779471 473456.374660081,659883.566461379 473451.177776091,659878.248918608 473447.811027505,659872.931368751 473444.444284755,659862.698827759 473437.981948996,659859.072242888 473435.671854328,659858.482539142 473435.295547687,659854.757136034 473432.942771075,659846.81499362 473427.923512011,659843.443516399 473425.790454771,659840.917758731 473424.180823052,659838.125988635 473422.423752475,659832.041619913 473418.575789215,659828.915898719 473416.599546276,659819.794350948 473410.827839061,659816.737447447 473408.893435042,659810.751419589 473405.108311047,659808.392458963 473403.613120257,659806.52489623 473402.431643118,659804.165929527 473400.936565561,659802.612966034 473399.953612359,659800.529111621 473398.63620289,659792.026701172 473393.261493288,659791.260177714 473392.770338918,659781.528976039 473386.621766959,659779.258627266 473385.179184501,659777.266496709 473383.074063709,659775.468176632 473381.1944055,659774.418690108 473380.085431933,659772.231911034 473377.784982726,659770.093454639 473375.545959185,659767.819253354 473373.15311745,659765.477049882 473370.688426544,659763.280838951 473368.36775864,659759.762242853 473364.680516096,659756.322207919 473361.045546241,659752.803854538 473357.348301458,659749.373554481 473353.723554242,659745.932932757 473350.108493347,659742.482629155 473346.483219574,659741.063577611 473344.994022696,659735.591683402 473339.242894918,659732.151362941 473335.61783882,659728.711037372 473331.992785223,659727.330883058 473330.54468278,659725.950727929 473329.096580742,659723.812554224 473326.847461702,659722.140840118 473325.091302504,659720.923964943 473322.797575538,659718.405520852 473318.017883937,659714.907883576 473311.391123439,659713.738503041 473309.18873132,659712.198728913 473306.276128016,659712.008464896 473305.920915022,659709.945726341 473302.023778904,659707.892726189 473298.136972395,659703.776720639 473290.363040902,659701.533448184 473286.120913465,659698.910029689 473281.158359254,659696.143913647 473275.931817989,659693.378044527 473270.695271013,659690.003682043 473264.31186533,659686.441720133 473260.383471797,659685.713742628 473259.58331532,659682.889498029 473256.465298402,659679.327524643 473252.536910226,659675.503720314 473248.311218143,659671.873731882 473244.310986612,659667.506011938 473239.5002756,659663.148599988 473234.679884601,659659.382519358 473230.535851721,659655.170840701 473225.869494112,659654.29735295 473224.905420332,659651.298225512 473221.602526275,659648.258212671 473220.868749816,659641.383827044 473219.199184342,659634.201264507 473217.461081018,659627.008951692 473215.712770833,659620.501812151 473214.143392473,659615.167254051 473212.846276667,659613.895530339 473212.541236566,659602.530974834 473209.777903645,659596.113470729 473208.22100759,659589.318454916 473206.573651128,659586.397814769 473205.863110853,659585.136155057 473205.558290236,659583.546645017 473205.174500755,659579.900650788 473204.293996015,659569.996260836 473201.890898734,659564.651683808 473200.593516676,659558.780469405 473199.171617582,659557.519127925 473198.856798839,659551.886613339 473197.481522544,659544.019269866 473195.554638236,659539.072758328 473194.328267366,659533.440559308 473192.942895816,659521.40087824 473190.000943986,659515.768666774 473188.615703817,659510.136203309 473187.240366325,659500.828691725 473184.95372209,659491.411712608 473182.644107306,659479.372311258 473179.692141904,659463.638098052 473175.818382724,659457.081783542 473174.217598679,659453.833583452 473173.417948779,659451.338668453 473173.22927181,659432.108259244 473171.749187887,659425.122759433 473171.206668169,659416.06149539 473170.506975157,659409.884055183 473170.03669643,659405.602824596 473169.708717774,659401.012661421 473169.342120972,659388.458481449 473168.376186279,659385.165182162 473168.125431239,659381.881881463 473167.874887836,659378.588581739 473167.624137173,659375.794408348 473167.407092457,659373.010161577 473167.190367716,659360.845207597 473166.255126789,659348.380995801 473165.291511758,659344.04977644 473164.962205874,659342.067919331 473166.477648147,659337.244907065 473170.204987926,659334.077406009 473172.64779459,659330.756407233 473175.216438799,659327.507289013 473177.717058963,659323.941498654 473180.459027056,659320.467013556 473183.153402586,659317.136282397 473185.71183894,659311.444594321 473190.115215298,659308.032069089 473192.741365756,659302.892369531 473196.709971512,659297.824554569 473200.610555817,659292.797557116 473204.482295737,659287.770250306 473208.363934641,659285.236386142 473210.314290357,659282.712454215 473212.264854384,659280.965110397 473213.616794763,659279.309889582 473214.891231099,659277.685163135 473216.146503225,659271.390949935 473221.003449642,659267.733038482 473223.822737274,659256.835058479 473225.90262202,659241.021524381 473228.896979706,659237.884749045 473229.500649897,659234.738166747 473230.093880976,659231.400388872 473230.731954407,659225.217502506 473231.91172246,659222.070923625 473232.504961492,659218.240479624 473233.239540682,659215.103897729 473233.833104383,659212.761528091 473234.278517541,659212.161369318 473234.281988204,659205.760331674 473234.305680146,659203.159906838 473234.313944031,659200.569293524 473234.332539112,659194.778597713 473234.342972628,659189.177581966 473234.368726462,659183.476604944 473234.391617936,659177.085503236 473234.415442487,659165.383472013 473234.46299786,659159.092405344 473234.489604883,659152.791272038 473234.516008681,659148.590624779 473234.530243524,659144.389977723 473234.544481922,659138.198809372 473234.573869902,659135.188412117 473234.580945808,659131.997898372 473234.592938082,659129.677557567 473234.599082329,659129.290550376 473234.488424858,659125.926076171 473233.555620875,659121.202181497 473232.235307815,659116.190417758 473230.837119025,659110.801390222 473229.338495654,659104.539015245 473227.595911933,659094.059058735 473224.666888213,659086.834256332 473222.647687001,659079.807666377 473220.693933911,659067.898416641 473217.375564254,659063.740483473 473216.200845079,659053.706967403 473213.404272034,659043.745418799 473207.269309782,658992.856340021 473175.915109318,658983.416179767 473170.094529916,658974.654480486 473164.692845236,658960.435044584 473155.930432214,658958.183005616 473154.548253191,658955.931281935 473153.156181168,658953.32525083 473151.554247248,658951.49603196 473150.433758318,658947.071024076 473147.701651865,658944.858390768 473146.340659441,658942.7343366 473145.032022397,658935.663928844 473140.676932554,658934.562610464 473139.996487507,658933.451292954 473139.315834172,658931.553730382 473138.133519416,658929.635924796 473136.960573407,658928.524925976 473136.269915987,658921.464241063 473131.925062804,658914.403795555 473127.570212518,658909.378581379 473124.481536512,658904.520837331 473121.487581707,658901.206857344 473119.446060088,658897.882944273 473117.404334452,658896.329364476 473116.441466799,658894.503292535 473115.93115282,658890.742144629 473114.877440067,658886.70304909 473113.746069684,658882.951897037 473112.692571333,658876.451633511 473110.87335067,658872.849465567 473109.854113771,658860.910774022 473106.514843159,658856.415053837 473105.260954989,658850.382664991 473101.704470305,658848.148673412 473100.392806497,658845.905001622 473099.070930135,658844.182922935 473098.05339476,658842.638000825 473097.140787418,658839.587252451 473095.346647802,658834.883258907 473092.576795204,658822.651135348 473085.369291459,658817.278105973 473082.201046309,658810.005955922 473077.910361946,658807.683680317 473076.536359607,658805.095417496 473075.014865524,658802.595729032 473073.545946975,658797.606986223 473070.588311568,658795.372967327 473069.276672062,658794.789823569 473069.390573746,658790.475284359 473070.271708122,658786.060527276 473071.160104184,658781.756238169 473072.031558077,658775.289936105 473073.333478351,658772.343270456 473073.932278969,658768.722919451 473074.662568924,658762.256377355 473075.974402267,658755.789835517 473077.286355124,658749.323620691 473078.588199937,658742.756870713 473079.907317149,658729.723601652 473082.538318318,658723.257014015 473083.850199824,658716.790749779 473085.15208446,658712.184761089 473086.085292478,658707.870509041 473086.956379436,658701.112271735 473088.330305841,658694.545234425 473089.659380321,658691.065869722 473090.353498974,658687.596569931 473091.047941447,658682.940293565 473091.989696675,658682.608327016 473092.060554004,658678.385019565 473089.994041823,658672.375829804 473087.048349205,658666.445541386 473084.144688969,658654.733044771 473078.401655043,658648.940730969 473075.571862476,658643.612496572 473072.954865216,658643.02467433 473072.148663119,658635.015430802 473061.217299679,658627.026145222 473050.286476985,658594.778436071 473006.225221178,658592.192534548 473002.803771999,658587.831865007 472997.013234274,658573.0871188 472938.363374352,658510.88796317 472921.868457115,658495.429948781 472917.772289719,658494.388206376 472917.833541213,658447.222512536 472904.873107439,658428.096878983 472905.036047693,658415.863315204 472905.13901033,658418.38858119 472901.688310357,658432.302875199 472882.690702586,658479.234714617 472796.71886752,658558.890882385 472658.035513992,658625.56344 472541.955783408,658636.446295434 472523.004574676,658701.468837819 472410.549474087,658766.48129552 472298.094106035,658847.094495894 472158.42689865,658931.046572797 472013.001186443,658997.176311752 471898.46628576,658998.657217384 471895.89695529,659003.66700169 471887.20444876,658927.556122748 471860.93584071,658831.963574102 471831.420206764,658687.04416676 471801.685539484,658571.749894184 471787.798115315,658565.011973913 471786.982482702,658503.512884424 471779.557542391,658495.59495983 471778.739322252,658434.941120366 471772.577863842,658272.494468593 471771.022038664,658135.039994532 471768.354675104,658130.061515285 471768.287444292,658015.11778616 471766.730457141,657885.418733631 471759.166537229,657745.592579641 471754.383709511,657700.343964014 471740.086280935,657665.486806743 471563.515886852,657643.653114336 471472.139157188,657618.45431586 471348.63803276,657595.708712641 471258.416315082,657590.412382404 471237.219133299,657562.31753946 471126.268963156,657559.175562696 471127.42241757,657444.617485554 471170.678714557,657441.189370621 471172.054420928,657295.455424273 471227.802437147,657183.270894792 471270.574085487,657179.066212465 471272.188258515,657142.678514824 471286.186620443,657023.808555576 471332.774209039,656861.618724775 471394.879052624,656806.222888381 471415.673970442,656799.674746621 471418.133599525,656732.692646245 471443.849582965,656536.631472156 471409.036000017,656425.759904219 471371.859509533,656303.836642579 471331.458307105,656213.243194223 471301.650781277,656107.388147498 471266.792610866,656097.490842463 471263.409773815,656093.735708869 471262.136242259,656082.481238524 471258.285962936,656002.475770386 471231.840488166,655964.519499062 471219.294090329,655883.463822348 471192.12961,655790.616554178 471161.370139684,655702.053981243 471132.628692914,655661.944852245 471118.732993755,655522.723654315 471073.155250625,655426.686254574 471040.947861792,655353.140849525 471016.330432172,655340.338213161 471012.047492004,655330.399593194 471008.713569893)))";
            //Polygon importPoint = GeometryEngine.Instance.ImportFromWKT(wktImportFlags, wktstring, new SpatialReferenceBuilder(2180).ToSpatialReference()) as Polygon;
            //return importPoint;

            //Get data from the endpoint 
            Log.Information("Preparing Commune request...");
            EsriHttpClient esriHttpClient = new EsriHttpClient();
            esriHttpClient.Timeout = TimeSpan.FromSeconds(10);

            EsriHttpResponseMessage responseMessage = esriHttpClient.Get(Constansts.FIND_COMMUNE_BY_ID_ULDK_URL + communeId);
            responseMessage.EnsureSuccessStatusCode();

            var response = await responseMessage.Content.ReadAsStringAsync();
            var status = response.Split("\n")[0];

            if (status != "0") { 
                Log.Fatal("GetCommuneExtentByIDAsync error. Status different than 0.");
                return null;
            
            }

            List<string> extentCoords = response.Split("\n")[1].Split(",").ToList();

            MapPoint minPt = MapPointBuilderEx.CreateMapPoint(Convert.ToDouble(extentCoords[0], CultureInfo.InvariantCulture), Convert.ToDouble(extentCoords[1], CultureInfo.InvariantCulture));
            MapPoint maxPt = MapPointBuilderEx.CreateMapPoint(Convert.ToDouble(extentCoords[2], CultureInfo.InvariantCulture), Convert.ToDouble(extentCoords[3], CultureInfo.InvariantCulture));

            // Create an envelope
            Envelope env = EnvelopeBuilderEx.CreateEnvelope(minPt, maxPt);
            PolygonBuilderEx polygonBuilderEx = new PolygonBuilderEx(env);
            polygonBuilderEx.SpatialReference = new SpatialReferenceBuilder(2180).ToSpatialReference();
            Polygon polygonFromEnv = polygonBuilderEx.ToGeometry() as Polygon;

            return polygonFromEnv;

        }

    }
}
